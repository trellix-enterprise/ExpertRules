# Detect Ryuk Ransomware Behavior By Triggering Memory Scan

## Author
McAfee

## Description
This rule trigger indicates a Ryuk ransomeware infection on the system. In order to block the ryuk infection, McAfee On-Access scan should be enabled with AmCore Content version (v3 DAT) 4343.5 or later.

## Rule Class 
Processes

## Rule TCL
```tcl
Rule {
Reaction SCAN ACTOR_PROCESS ScanAction REPORT_CLEAN_DELETE_PROCESS

                Process {
                                Include OBJECT_NAME { -v "**.exe"  }
								Exclude OBJECT_NAME { -v "**\\Program Files\\**" }
								Exclude OBJECT_NAME { -v "**\\Program Files (x86)\\**" }
								Exclude OBJECT_NAME { -v "**\\ProgramData\\**" }
								Exclude OBJECT_NAME { -v "**\\Windows\\**" }
								Exclude VTP_PRIVILEGES -type BITMASK { -v 0x8 }
								Include OBJECT_NAME { -v "**\\Windows\\Temp\\*.exe" }
 
                }
Target {
                Match PROCESS {
                
                            Include OBJECT_NAME { -v "**.exe"  }
							Exclude VTP_PRIVILEGES -type BITMASK { -v 0x8 }
							
							Include PROCESS_CMD_LINE { -v "**8 LAN" }
                                        
                Include -file_attributes "!HIDDEN"
				Exclude -file_attributes "!SYSTEM"

                                                                
                Include -access "CREATE"
                }
       }
}
```

## Trigger
Sample(s) Tested:
42B0B731D85E5444A87E147A404AC57BE34BF87B40294CB2D4664F9A2AAA0E3F

## Tested Platforms
OS: Windows 10 20H1 x86
    Windows Server 2019 x64
ENS: 10.7.0 November'20 update 
AMCore Content Version (v3 DAT): 4343.5

## Notes
This rule works only on McAfee Endpoint Security (ENS) versions 10.7.0 or higher. In order to block the Ryuk infection, McAfee On-Access scan should be enabled with AmCore Content version (v3 DAT) 4343.5 or later.
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives observed.