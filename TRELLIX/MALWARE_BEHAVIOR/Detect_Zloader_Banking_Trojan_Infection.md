# Detect Zloader Banking Trojan Infection

## Author
Trellix

## Description
Zloader is a banking trojan that uses webinjects and VNC clients to steal banking credentials from the victim. This event indicates a malicious behavior exhibited by one of the variants of Zloader banking trojan. 

## Rule Class 
Processes

## Rule TCL
```tcl
Rule {
	Process {
		Include OBJECT_NAME { -v "excel.exe" }
	}
	Target {
		Match PROCESS {
			Include OBJECT_NAME { -v "rundll32.exe" }
			Include PROCESS_CMD_LINE { -v "**Shell32.dll,Control_RunDLL**" }
			Include -access "CREATE"
		}
		Next_Process_Behavior {
			Target {
				Match SECTION {
					Include OBJECT_NAME { -v "**\\users\\*\\appdata\\Local\\temp\\**.cpl" }
					Include OBJECT_NAME { -v "**\\users\\*\\appdata\\Local\\temp\\**.dll" }
				}
			}
		}
	}
}

```

## Trigger
NA

## Tested Platforms
OS: Windows 10 20H1 x86
ENS: 10.7.0 November'20 update

## Notes
This rule is applicable only on ENS 10.7.0 or above versions
This rule trigger indicates the detection of Zloader banking trojan which arrives as spam containing word document as an attachment. When the document is opened and macros are enabled, it downloads a malicous excel file. This excel macro downloads Zloader dll from a malicious URL and executes by invoking rundll32.exe. This rule detects and blocks this behaviour of excel.exe.