# Detect QBot Banking Trojan Infection

## Author
Trellix

## Description
Qbot (also known as Qakbot, Quakbot, and Pinkslipbot) is a Windows banking trojan with worm features active since at least 2009 and used to steal banking credentials, personal information, and financial data.
This event indicates a malicious behavior exhibited by one of the variants of QBot banking trojan. 

## Rule Class 
Processes

## Rule TCL
```tcl
Rule {
    Process {
        Include OBJECT_NAME { -v explorer.exe }
    }
    Target {
        Match PROCESS {
            Include OBJECT_NAME { -v wscript.exe }
	    Include PROCESS_CMD_LINE { -v "**\\programdata\\*.vbs*" }
            Include -access "CREATE"
        }

        Next_Process_Behavior {
            Target {
                Match PROCESS {
                    Include OBJECT_NAME { -v cmd.exe }
                    Include PROCESS_CMD_LINE { -v "**c:\\*\\*.cmd*" }
                    Include -access "CREATE"
                }
				 Next_Process_Behavior {
					Target {
						Match PROCESS {
						Include OBJECT_NAME { -v powershell.exe }
						Include -access "CREATE"
						}
					}
				}
			}
		}
	}
}

```

## Trigger
NA

## Tested Platforms
OS: Windows 10 19H1 x64
ENS: 10.7.0 November'20 update

## Notes
This rule is applicable only on ENS 10.7.0 or above versions.
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.