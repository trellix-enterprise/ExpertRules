# CVE-2023-36394 : Arbitrary File Creation due to Improper Processing of Symlinks

## Author
Trellix EP Content

## Rule Class 
Files

## Description
This rule trigger indicates an attempt to create arbitrary file from Search Service, that may lead to elevation of privilege (EoP).

## Rule TCL
```tcl
Rule {
		Target {
			Match FILE {
						Include OBJECT_NAME {-v "**\\Users\\*\\AppData\\Local\\Microsoft\\InputPersonalization\\TextHarvester"}
						Include -access "SET_REPARSE"
			}
			Next_Process_Behavior {
				Target {
					Match FILE {
						Include OBJECT_NAME {-v "InputPersonalization.exe"}
						Include -access "EXECUTE"
					}    
					Next_Process_Behavior {
						Target {
							Match FILE {
								Include OBJECT_NAME {-v "**pipe\\SearchTextHarvester"}
								Include -access "CONNECT_NAMED_PIPE"
							}    
						}
					}
                     
                }
            }
        }
	}
```

## Tested Platforms
OS: Windows 11
ENS: 10.7.0

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives. 
