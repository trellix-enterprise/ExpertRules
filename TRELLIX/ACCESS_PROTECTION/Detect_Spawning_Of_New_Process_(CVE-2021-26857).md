# Detect spawning of new process (CVE-2021-26857)

## Author
Trellix

## Description
This expert rule detects spawning of a new process to detect the vulnerability CVE-2021-26857, which is a part of the Microsoft Exchange Server based Remote Code Execution attack chain. 

## Rule Class 
Processes

## Rule TCL
```tcl
Rule {
	set os_arch [iSystem os_arch]
	Process {
		Include OBJECT_NAME { -v "UMWorkerProcess.exe" }
	}
	Target {
		Match PROCESS {
				Exclude OBJECT_NAME {
					-v "%windir%\\System32\\werfault.exe"
					-v "%windir%\\System32\\wermgr.exe"										-
				}
				if { $os_arch == 640 } {
					Exclude OBJECT_NAME {
						-v "%windir%\\Syswow64\\werfault.exe"
						-v "%windir%\\Syswow64\\wermgr.exe"										-
					}
				} 									
				Include -access "CREATE"
		}
	}
}

```

## Trigger
NA

## Tested Platforms
OS: Windows Server 2016, Windows Server 2019
ENS: 10.7.0 November'20 update

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.