# CVE-2021-41379: Windows Installer Elevation of Privilege Vulnerability

## Author
Trellix

## Description
TThis Expert rule detects an attempt to abuse the Privilege escalation vulnerability in windows installer by detecting the drop of pre-requisite files in specific location.

## Rule Class 
Files

## Rule TCL
```tcl
Rule {
	Process {
		Include AggregateMatch -xtype "ex1" {
			Exclude VTP_PRIVILEGES -type BITMASK { -v 0x8 }

		}				
	}
	Target {
		Match FILE {
			Include OBJECT_NAME { -v "%systemdrive%\\Users\\*\\appdata\\local\\temp\\**\\splwow64.exe" }	
			Include OBJECT_NAME { -v "%systemdrive%\\Users\\*\\appdata\\local\\temp\\**\\**.png" }	
			Include OBJECT_NAME { -v "%systemdrive%\\Users\\*\\appdata\\local\\temp\\**\\microsoft plz\\**.exe" }
			Include OBJECT_NAME { -v "**\\Microsoft\\Edge\\Application\\**\\**.exe" }			
			Include -access "CREATE WRITE RENAME EXECUTE"
		}
	}
}
```

## Tested Platforms
OS: Windows 10 20H1 x64 and x86
ENS: 10.7.0 November'20 update

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.
