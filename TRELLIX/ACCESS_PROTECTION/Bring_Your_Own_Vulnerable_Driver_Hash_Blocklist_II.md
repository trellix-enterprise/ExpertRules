# Bring Your Own Vulnerable Driver Hash Blocklist II

## Author
Trellix

## Description
The expert rule detects and blocks the driver load for listed vulnerable driver hashes.

## Rule Class 
File

## Rule TCL
```tcl
Rule {
			Process {
				Include OBJECT_NAME { -v "SYSTEM" }
			}
			Target {
				Match FILE {
					Include SHA2_256 { 
									-v "19dba69b48b085d9487cc23a4135f3ef4849c181965bffc55baed9fa6c205429"
									-v "5f5e5f1c93d961985624768b7c676d488c7c7c1d4c043f6fc1ea1904fefb75be"
									-v "2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d"
									-v "09043c51719d4bf6405c9a7a292bb9bb3bcc782f639b708ddcc4eedb5e5c9ce9"
									-v "b78eb7f12ba718183313cf336655996756411b7dcc8648157aaa4c891ca9dbee"
									-v "4ae42c1f11a98dee07a0d7199f611699511f1fb95120fabc4c3c349c485467fe"
									-v "8bf84bed9b5fa4576182c84d2f31679dc472acd0f83c9813498e9f71ed9fef3e"
									-v "fcdfe570e6dc6e768ef75138033d9961f78045adca53beb6fdb520f6417e0df1"
									-v "c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5"
									-v "23787eb342fd38da73ce785023176f98304267c6f6fa8a50e718da096c7a7951"
									-v "025e7be9fcefd6a83f4471bba0c11f1c11bd5047047d26626da24ee9a419cdc4"
									-v "bfc2ef3b404294fe2fa05a8b71c7f786b58519175b7202a69fe30f45e607ff1c"
									-v "06508aacb4ed0a1398a2b0da5fa2dbf7da435b56da76fd83c759a50a51c75caf"
									-v "37022838c4327e2a5805e8479330d8ff6f8cd3495079905e867811906c98ea20"
									-v "c1c4310e5d467d24e864177bdbfc57cb5d29aac697481bfa9c11ddbeebfd4cc8"
									-v "00c3e86952eebb113d91d118629077b3370ebc41eeacb419762d2de30a43c09c"
									-v "6dafd15ee2fbce87fef1279312660fc399c4168f55b6e6d463bf680f1979adcf"
									-v "6b830ea0db6546a044c9900d3f335e7820c2a80e147b0751641899d1a5aa8f74"
									-v "0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5"
									-v "823da894b2c73ffcd39e77366b6f1abf0ae9604d9b20140a54e6d55053aadeba"
									-v "f596e64f4c5d7c37a00493728d8756b243cfdc11e3372d6d6dfeffc13c9ab960"
									-v "dd628061d6e53f3f0b44f409ad914b3494c5d7b5ff6ff0e8fc3161aacec93e96"
									-v "17942865680bd3d6e6633c90cc4bd692ae0951a8589dbe103c1e293b3067344d"
									-v "9a91d6e83b8fdec536580f6617f10dfc64eedf14ead29a6a644eb154426622ba"
									-v "e5b0772be02e2bc807804874cf669e97aa36f5aff1f12fa0a631a3c7b4dd0dc8"
									-v "035b96ff8b85d312be0f9df6271714392a802ec8bab59ae8229812ddc67ced5a"
									-v "86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219"
									-v "2121a2bb8ebbf2e6e82c782b6f3c6b7904f686aa495def25cf1cf52a42e16109"
									-v "31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427"
									-v "6cb51ae871fbd5d07c5aad6ff8eea43d34063089528603ca9ceb8b4f52f68ddc"
									-v "7cc9ba2df7b9ea6bb17ee342898edd7f54703b93b6ded6a819e83a7ee9f938b4"
									-v "33bdaf3ab141db0f4c6a2c1f9fb047b4e5c6fa6ddc709d905efdd24c2b43041c"
									-v "0aafa9f47acf69d46c9542985994ff5321f00842a28df2396d4a3076776a83cb"
									-v "6709a2d7925248fe172e9bc5495f45b9bb74060c43e1c58e671f0e6c434fd82b"
									-v "ea0b9eecf4ad5ec8c14aec13de7d661e7615018b1a3c65464bf5eca9bbf6ded3"
									-v "3a95cc82173032b82a0ffc7d2e438df64c13bc16b4574214c9fe3be37250925e"
									-v "3f20ac5dac9171857fc5791865458fdb6eac4fab837d7eabc42cb0a83cb522fc"
									-v "274340f7185a0cc047d82ecfb2cce5bd18764ee558b5227894565c2f9fe9f6ab"
									-v "3c6f9917418e991ed41540d8d882c8ca51d582a82fd01bff6cdf26591454faf5"
									-v "9d530642aeb6524691d06b9e02a84e3487c9cdd86c264b105035d925c984823a"
									-v "0de4247e72d378713bcf22d5c5d3874d079203bb4364e25f67a90d5570bdcce8"
									-v "4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6"
									-v "21ccdd306b5183c00ecfd0475b3152e7d94b921e858e59b68a03e925d1715f21"
									-v "05f052c64d192cf69a462a5ec16dda0d43ca5d0245900c9fcb9201685a2e7748"
									-v "1b7fb154a7b7903a3c81f12f4b094f24a3c60a6a8cffca894c67c264ab7545fa"
									-v "06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50"
									-v "ea85bbe63d6f66f7efee7007e770af820d57f914c7f179c5fee3ef2845f19c41"
									-v "0040153302b88bee27eb4f1eca6855039e1a057370f5e8c615724fa5215bada3"
									-v "20f11a64bc4548f4edb47e3d3418da0f6d54a83158224b71662a6292bf45b5fb"
									-v "2695390a8a7448390fe383beb1eee06d582202683f0273d6e72ef39a8cf709e1"
									-v "23ba19352b1e71a965260bf4d5120f0200709ee8657ed381043bec9a938a1ade"
									-v "ded2927f9a4e64eefd09d0caba78e94f309e3a6292841ae81d5528cab109f95d"
									-v "455bc98ba32adab8b47d2d89bdbadca4910f91c182ab2fc3211ba07d3784537b"
									-v "09bedbf7a41e0f8dabe4f41d331db58373ce15b2e9204540873a1884f38bdde1"
									-v "525d9b51a80ca0cd4c5889a96f857e73f3a80da1ffbae59851e0f51bdfb0b6cd"
									-v "e4a7da2cf59a4a21fc42b611df1d59cae75051925a7ddf42bf216cc1a026eadb"
									-v "965d4f981b54669a96c5ab02d09bf0a9850d13862425b8981f1a9271350f28bb"
									-v "994f322def98c99aec7ea0036ef5f4b802120458782ae3867d116d55215c56e4"
									-v "146d77e80ca70ea5cb17bfc9a5cea92334f809cbdc87a51c2d10b8579a4b9c88"
									-v "092d04284fdeb6762e65e6ac5b813920d6c69a5e99d110769c5c1a78e11c5ba0"
									-v "4e3eb5b9bce2fd9f6878ae36288211f0997f6149aa8c290ed91228ba4cdfae80"
									-v "e86cb77de7b6a8025f9a546f6c45d135f471e664963cf70b381bee2dfd0fdef4"
									-v "db2a9247177e8cdd50fe9433d066b86ffd2a84301aa6b2eb60f361cfff077004"
									-v "3d23bdbaf9905259d858df5bf991eb23d2dc9f4ecda7f9f77839691acef1b8c4"
									-v "e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf"
									-v "f8c07b6e2066a5a22a92d9f521ecdeb8c68698c400e4b83e0501b9f340957c22"
									-v "64f9e664bc6d4b8f5f68616dd50ae819c3e60452efd5e589d6604b9356841b57"
									-v "4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1"
									-v "221dfbc74bbb255b0879360ccc71a74b756b2e0f16e9386b38a9ce9d4e2e34f9"
									-v "72b99147839bcfb062d29014ec09fe20a8f261748b5925b00171ef3cb849a4c1"
									-v "cc383ad11e9d06047a1558ed343f389492da3ac2b84b71462aee502a2fa616c8"
									-v "91afa3de4b70ee26a4be68587d58b154c7b32b50b504ff0dc0babc4eb56578f4"
									-v "0ebaef662b14410c198395b13347e1d175334ec67919709ad37d65eba013adff"
									-v "dd573f23d656818036fc9ae1064eda31aca86acb9bc44a6e127db3ea112a9094"
									-v "3c0a36990f7eef89b2d5f454b6452b6df1304609903f31f475502e4050241dd8"
									-v "b17507a3246020fa0052a172485d7b3567e0161747927f2edf27c40e310852e0"
									-v "f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe"
									-v "f1718a005232d1261894b798a60c73d971416359b70d0e545d7e7a40ed742b71"
									-v "a4680fabf606d6580893434e81c130ff7ec9467a15e6534692443465f264d3c9"
									-v "270547552060c6f4f5b2ebd57a636d5e71d5f8a9d4305c2b0fe5db0aa2f389cc"
									-v "f40435488389b4fb3b945ca21a8325a51e1b5f80f045ab019748d0ec66056a8b"
									-v "2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8"
									-v "f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35"
									-v "223f61c3f443c5047d1aeb905b0551005a426f084b7a50384905e7e4ecb761a1"
									-v "05c15a75d183301382a082f6d76bf3ab4c520bf158abca4433d9881134461686"
									-v "065a34b786b0ccf6f88c136408943c3d2bd3da14357ee1e55e81e05d67a4c9bc"
									-v "0be4912bfd7a79f6ebfa1c06a59f0fb402bd4fe0158265780509edd0e562eac1"
									-v "e6a7a497010579fde69cd52bed8de28db610c33bbc5ce0774459dcf64657b802"
									-v "09b0e07af8b17db1d896b78da4dd3f55db76738ee1f4ced083a97d737334a184"
									-v "6165491e8391eac9c0e3b9a2a31e1692a567c16cbfa36d7a88c401ffae1f6c63"
									-v "0b57569aaa0f4789d9642dd2189b0a82466b80ad32ff35f88127210ed105fe57"
									-v "b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29"
									-v "15c53eb3a0ea44bbd2901a45a6ebeae29bb123f9c1115c38dfb2cdbec0642229"
									-v "dcd026fd2ff8d517e2779d67b3d2d5f9a7aa39f19c66fa8ff2cab66d5c6461c6"
									-v "552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9"
									-v "80cbba9f404df3e642f22c476664d63d7c229d45d34f5cd0e19c65eb41becec3"
									-v "37c637a74bf20d7630281581a8fae124200920df11ad7cd68c14c26cc12c5ec9"
									-v "1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8"
									-v "29e0062a017a93b2f2f5207a608a96df4d554c5de976bd0276c2590a03bd3e94"
									-v "bdc73f752c1353d41e877d8bf42a1c53f0bba7d6f52348aaef60e06f4d3087d0"
					}
					Include -access "EXECUTE"
				}
			}
		}
```

## Tested Platforms
OS: Windows 10 20H1 x64 and x86
ENS: 10.7.0

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.