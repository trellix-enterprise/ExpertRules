# CVE-2025-54100 PowerShell Remote Code Execution

## Author
Trellix

## Description
This expert rule detects PowerShell command injection vulnerability where Invoke-WebRequest may unintentionally execute embedded scripts while parsing malicious HTML content using the MSHTML engine.


## Rule Class 
File

## Rule TCL
```tcl
Rule {
			Process {
					Include OBJECT_NAME { -v "powershell.exe" }
					Include AggregateMatch -xtype "inc1" {
						Include DLL_LOADED -name "mshtml" { -v 0x1 }
					}
					Include AggregateMatch -xtype "inc2" {
						Include DLL_LOADED -name "winhttp" { -v 0x1 }
					}
			}
			Target {
					Match FILE {
							Include OBJECT_NAME { -v "jscript.dll" }
							Include OBJECT_NAME { -v "jscript9.dll" }
							Include OBJECT_NAME { -v "vbscript.dll" }
							Include -access "EXECUTE"
					}
				}
			}
```

## Tested Platforms
OS: Windows 10 20H1 x86 and Windows 10 x64
ENS: 10.7.0

## Notes
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.