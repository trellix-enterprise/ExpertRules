# Detect creation of malicious archive file (CVE-2021-25274)

## Author
Trellix

## Description
This expert rule is to restrict any untrusted process creating a malicious .Archive on the system. Similar behaviour is observed in attacks against CVE-2021-25274 - The Collector Service in SolarWinds Orion Platform before 2020.2.4 uses MSMQ (Microsoft Message Queue) and doesn't set permissions on its private queues. As a result, remote unauthenticated clients can send messages to TCP port 1801 that the Collector Service will process. Additionally, upon processing of such messages, the service deserializes them in insecure manner, allowing remote arbitrary code execution as LocalSystem.

## Rule Class 
Files

## Rule TCL
```tcl
Rule {
	Process {
		Include OBJECT_NAME { -v "**"  }
		Exclude CERT_NAME { -v "*SolarWinds Worldwide*" }
	}
	Target {
		Match FILE {
		Include OBJECT_NAME {  -v "C:\\ProgramData\\RhinoSoft\\Serv-U\\Users\\*\\*.Archive"}
		Include -access "CREATE WRITE"
		}
	}
}

```

## Trigger
NA

## Tested Platforms
OS: Windows 10 20H1 x86, Win 8.1 x64
ENS: 10.7.0 November'20 update

## Notes
Affected version : ServU-FTP 15.2.1 or less
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.